(this["webpackJsonpmy-points"]=this["webpackJsonpmy-points"]||[]).push([[0],{303:function(e,t,n){},304:function(e,t,n){},325:function(e,t,n){},342:function(e,t,n){"use strict";n.r(t);var a,c=n(0),r=n(39),o=n.n(r),s=n(59),i=n(70),u=n(34),l=n(20),p=n(6),d=n(44),b=n(208);!function(e){e.READ_POINTS_BALANCE="READ_POINTS_BALANCE",e.SET_POINTS_BALANCE="SET_POINTS_BALANCE",e.REDEEM_POINTS="REDEEM_POINTS"}(a||(a={}));var j,O=function(e){return{type:a.READ_POINTS_BALANCE,payload:e}},f=function(e){return{type:a.SET_POINTS_BALANCE,payload:e}},_=function(e){return{type:a.REDEEM_POINTS,payload:e}},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;if(t.type===a.SET_POINTS_BALANCE){var n=t.payload,c=n.data;return c}return e},y=n(2),h=n(119),S=n.n(h);!function(e){e.READ_USER_COUPONS="READ_USER_COUPONS",e.SET_USER_COUPONS="SET_USER_COUPONS",e.SET_USER_COUPON="SET_USER_COUPON"}(j||(j={}));var m,E=function(e){return{type:j.READ_USER_COUPONS,payload:e}},v=function(e){return{type:j.SET_USER_COUPONS,payload:e}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j.SET_USER_COUPONS:var n=t.payload,a=n.data;return a;case j.SET_USER_COUPON:var c=t.payload,r=c.data,o=e.findIndex((function(e){return e.id===r.id}));if(o<0)return[r].concat(Object(p.a)(e));var s=S()(e);return s[o]=Object(y.a)(Object(y.a)({},s[o]),r),s;default:return e}};!function(e){e.READ_HISTORY_ENTRIES="READ_HISTORY_ENTRIES",e.SET_HISTORY_ENTRIES="SET_HISTORY_ENTRIES",e.SET_HISTORY_ENTRY="SET_HISTORY_ENTRY"}(m||(m={}));var N=function(e){return{type:m.READ_HISTORY_ENTRIES,payload:e}},T=function(e){return{type:m.SET_HISTORY_ENTRIES,payload:e}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m.SET_HISTORY_ENTRIES:var n=t.payload,a=n.data;return a;case m.SET_HISTORY_ENTRY:var c=t.payload,r=c.data,o=e.findIndex((function(e){return e.id===r.id}));if(o<0)return[r].concat(Object(p.a)(e));var s=S()(e);return s[o]=Object(y.a)(Object(y.a)({},s[o]),r),s;default:return e}},R=n(29),I=n.n(R),w=n(38),P=(n(150),n(195)),A=n.n(P).a.create({baseURL:wpApiSettings.root,timeout:3e4,headers:{"X-WP-Nonce":wpApiSettings.nonce}}),k=I.a.mark(U),B=I.a.mark(M);function U(e){var t,n,a,c,r;return I.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,n=t.processingCB,a=t.successCB,c=t.failCB,o.prev=1,"function"===typeof n&&n(),o.next=5,Object(w.b)((function(){return A.get("loyalty-program/v1/mypoints")}));case 5:if(!(r=o.sent)||!r.data){o.next=10;break}return o.next=9,Object(w.c)(f({data:r.data}));case 9:"function"===typeof a&&a(r);case 10:o.next=15;break;case 12:o.prev=12,o.t0=o.catch(1),"function"===typeof c&&c({error:o.t0});case 15:case"end":return o.stop()}}),k,null,[[1,12]])}function M(e){var t,n,a,c,r,o;return I.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload,n=t.points,a=t.processingCB,c=t.successCB,r=t.failCB,s.prev=1,"function"===typeof a&&a(),s.next=5,Object(w.b)((function(){return A.post("loyalty-program/v1/mypoints/redeem",{points:n})}));case 5:if(!(o=s.sent)||!o.data){s.next=14;break}return s.next=9,Object(w.c)(f({data:o.data.balance}));case 9:return s.next=11,Object(w.c)(E({page:1}));case 11:return s.next=13,Object(w.c)(N({page:1}));case 13:"function"===typeof c&&c(o);case 14:s.next=19;break;case 16:s.prev=16,s.t0=s.catch(1),"function"===typeof r&&r({error:s.t0});case 19:case"end":return s.stop()}}),B,null,[[1,16]])}var D=[Object(w.d)(a.READ_POINTS_BALANCE,U),Object(w.d)(a.REDEEM_POINTS,M)],H=I.a.mark(L);function L(e){var t,n,a,c,r,o;return I.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload,n=t.page,a=t.processingCB,c=t.successCB,r=t.failCB,s.prev=1,"function"===typeof a&&a(),s.next=5,Object(w.b)((function(){return A.get("loyalty-program/v1/mypoints/coupons",{params:{page:n}})}));case 5:if(!(o=s.sent)||!o.data){s.next=10;break}return s.next=9,Object(w.c)(v({data:o.data}));case 9:"function"===typeof c&&c(o);case 10:s.next=15;break;case 12:s.prev=12,s.t0=s.catch(1),"function"===typeof r&&r({error:s.t0});case 15:case"end":return s.stop()}}),H,null,[[1,12]])}var Y=[Object(w.d)(j.READ_USER_COUPONS,L)],F=I.a.mark(z);function z(e){var t,n,a,c,r,o;return I.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload,n=t.page,a=t.processingCB,c=t.successCB,r=t.failCB,s.prev=1,"function"===typeof a&&a(),s.next=5,Object(w.b)((function(){return A.get("loyalty-program/v1/mypoints/history",{params:{page:n}})}));case 5:if(!(o=s.sent)||!o.data){s.next=10;break}return s.next=9,Object(w.c)(T({data:o.data}));case 9:"function"===typeof c&&c(o);case 10:s.next=15;break;case 12:s.prev=12,s.t0=s.catch(1),"function"===typeof r&&r({error:s.t0});case 15:case"end":return s.stop()}}),F,null,[[1,12]])}var q=[Object(w.d)(m.READ_HISTORY_ENTRIES,z)],J=I.a.mark(K);function K(){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.a)([].concat(Object(p.a)(D),Object(p.a)(Y),Object(p.a)(q)));case 2:case"end":return e.stop()}}),J)}var W=function(e){return(0,n(302).composeWithDevTools)(d.applyMiddleware.apply(void 0,Object(p.a)(e)))};n(303),n(304);var G=n(5),X=n(344),Q=n(346),V=n(67),Z=n(343),$=n(206),ee=function(){return lpfwMyPoints.page_url.replace(location.origin,"")},te=n(11),ne=E,ae=ee(),ce=Object(s.b)((function(e){return{coupons:e.coupons}}),(function(e){return{actions:Object(d.bindActionCreators)({readUserCoupons:ne},e)}}))((function(e){var t=e.coupons,n=e.actions,a=lpfwMyPoints,r=a.cart_url,o=a.labels,s=Object(c.useState)(!1),u=Object(G.a)(s,2),l=u[0],p=u[1],d=Object(c.useState)(!1),b=Object(G.a)(d,2),j=b[0],O=b[1],f=Object(c.useState)(1),_=Object(G.a)(f,2),x=_[0],y=_[1],h=Object(c.useState)(0),S=Object(G.a)(h,2),m=S[0],E=S[1];if(Object(c.useEffect)((function(){n.readUserCoupons({page:1,successCB:function(e){E(e.headers["x-total"]),p(!0)}})}),[]),!l)return Object(te.jsx)(Q.a,{active:!0});var v=[{title:"".concat(o.coupon_code),dataIndex:"code",key:"code"},{title:"".concat(o.amount),dataIndex:"amount",key:"amount"},{title:"".concat(o.redeem_date),dataIndex:"date_created",key:"date_created"},{title:"".concat(o.expire_date),dataIndex:"date_expire",key:"date_expire"},{title:"".concat(o.action),dataIndex:"code",key:"code",render:function(e,t){return Object(te.jsx)(V.a,{href:"".concat(r,"?lpfw_coupon=").concat(t.code),type:"primary",children:o.apply_coupon})}}];return Object(te.jsxs)("div",{className:"user-coupons",children:[Object(te.jsx)("h3",{children:o.reward_coupons}),t.length?Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)("div",{className:"redeem-points",children:Object(te.jsx)("p",{children:Object(te.jsx)(i.b,{to:"".concat(ae,"lpfw-my-points/?tab=redeem"),children:o.click_to_redeem})})}),Object(te.jsx)(Z.a,{loading:j,pagination:!1,dataSource:t,columns:v}),m?Object(te.jsx)($.a,{defaultCurrent:x,hideOnSinglePage:!0,current:x,total:m,pageSize:10,showSizeChanger:!1,onChange:function(e){y(e),O(!0),n.readUserCoupons({page:e,successCB:function(){return O(!1)}})}}):null]}):Object(te.jsxs)("p",{children:[o.no_coupons_found," ",Object(te.jsx)(i.b,{to:"".concat(ae,"lpfw-my-points/?tab=redeem"),children:o.click_to_redeem})]})]})})),re=function(e){var t=e.balance,n=lpfwMyPoints,a=n.labels,c=n.points_expiry_note,r=t.points,o=t.worth,s=t.expiry;return Object(te.jsxs)("p",{children:[Object(te.jsx)("span",{className:"points-worth-text",dangerouslySetInnerHTML:{__html:a.points_worth.replace("{p}",r.toLocaleString()).replace("{w}",o)}}),Object(te.jsx)("br",{}),0<r&&s?Object(te.jsx)("span",{className:"points-expiry-text",style:{fontSize:13},children:Object(te.jsx)("em",{children:c.replace("{date_expire}",s)})}):null]})},oe=O,se=Object(s.b)((function(e){return{balance:e.balance,coupons:e.coupons}}),(function(e){return{actions:Object(d.bindActionCreators)({readPointsBalance:oe},e)}}))((function(e){var t=e.balance,n=e.actions,a=lpfwMyPoints.labels,r=Object(c.useState)(!1),o=Object(G.a)(r,2);o[0],o[1];return Object(c.useEffect)((function(){n.readPointsBalance({})}),[]),t?Object(te.jsxs)(te.Fragment,{children:[Object(te.jsxs)("div",{className:"points-balance",children:[Object(te.jsx)("h3",{children:a.points_balance}),Object(te.jsx)(re,{balance:t})]}),Object(te.jsx)(ce,{})]}):Object(te.jsx)(Q.a,{active:!0})})),ie=n(200),ue=N,le=Object(s.b)((function(e){return{entries:e.history}}),(function(e){return{actions:Object(d.bindActionCreators)({readHistoryEntries:ue},e)}}))((function(e){var t=Object(ie.defaults)(e,{entries:[]}),n=t.entries,a=t.actions,r=lpfwMyPoints.labels,o=Object(c.useState)(!0),s=Object(G.a)(o,2),i=s[0],u=s[1],l=Object(c.useState)(1),p=Object(G.a)(l,2),d=p[0],b=p[1],j=Object(c.useState)(0),O=Object(G.a)(j,2),f=O[0],_=O[1],x=[{title:"".concat(r.date),dataIndex:"date",key:"date"},{title:"".concat(r.activity),dataIndex:"activity",key:"activity"},{title:"".concat(r.points),dataIndex:"points",key:"points",render:function(e){return e.toLocaleString()}},{title:"".concat(r.related),dataIndex:"rel_label",key:"rel_label",render:function(e,t){return Object(te.jsx)(te.Fragment,{children:t.rel_link?Object(te.jsx)("a",{href:t.rel_link,target:"_blank",children:e}):Object(te.jsx)("span",{children:e})})}}];Object(c.useEffect)((function(){n.length||a.readHistoryEntries({page:1,successCB:function(e){_(e.headers["x-total"]),u(!1)}})}),[]);return Object(te.jsxs)("div",{className:"user-points-history",children:[Object(te.jsx)("h3",{children:r.points_history}),Object(te.jsx)(Z.a,{loading:i,pagination:!1,dataSource:n,columns:x}),f&&!i?Object(te.jsx)($.a,{defaultCurrent:d,hideOnSinglePage:!0,current:d,total:f,pageSize:10,showSizeChanger:!1,onChange:function(e){b(e),u(!0),a.readHistoryEntries({page:e,successCB:function(){return u(!1)}})}}):null]})})),pe=n(207),de=n(347),be=n(348),je=n(345),Oe=(n(325),O),fe=_,_e=ee(),xe=Object(s.b)((function(e){return{balance:e.balance}}),(function(e){return{actions:Object(d.bindActionCreators)({readPointsBalance:Oe,redeemPoints:fe},e)}}))((function(e){var t=e.balance,n=e.actions,a=lpfwMyPoints,r=a.labels,o=a.currency_ratio,s=a.redeem_ratio,u=a.currency_symbol,l=a.coupon_expire_period,p=a.minimum_points_redeem,d=a.maximum_points_redeem,b=a.decimals,j=Object(c.useState)(0),O=Object(G.a)(j,2),f=O[0],_=O[1],x=Object(c.useState)(0),y=Object(G.a)(x,2),h=y[0],S=y[1],m=Object(c.useState)(!1),E=Object(G.a)(m,2),v=E[0],g=E[1],N=1/s*o;if(Object(c.useEffect)((function(){n.readPointsBalance({})}),[]),!t)return Object(te.jsx)(Q.a,{active:!0});var T=0<d?Math.min(t.points,d):t.points;return Object(te.jsxs)("div",{className:"points-redeem",children:[Object(te.jsx)("h3",{children:r.redeem_points}),Object(te.jsx)("p",{children:r.redeem_desc}),Object(te.jsx)(re,{balance:t}),Object(te.jsxs)(de.a,{className:"form-wrap",gutter:10,children:[Object(te.jsxs)(be.a,{span:11,children:[Object(te.jsxs)("label",{children:[r.enter_points,":"]}),Object(te.jsx)(je.a,{min:p,max:T,step:1,value:f,onChange:function(e){if("undefined"!==typeof e&&!((e="string"===typeof e?parseInt(e):e)<p)){var n="string"===typeof e?parseInt(e):e,a=(n=Math.min(n,t.points))/s*o;isNaN(a)&&(a=0,n=0),S(a.toFixed(b)),_(parseInt(n.toString()))}}})]}),Object(te.jsx)(be.a,{span:1,children:Object(te.jsx)("span",{className:"equal-sign",children:"="})}),Object(te.jsxs)(be.a,{span:11,children:[Object(te.jsxs)("label",{children:[r.enter_amount," (",u,"):"]}),Object(te.jsx)(je.a,{min:0,step:N.toFixed(b),value:h,onChange:function(e){if("undefined"!==typeof e){var n="string"===typeof e?parseFloat(e):e;if(!(n<0)){var a=Math.floor(n/o*s);n=(a=Math.min(a,t.points))/s*o,isNaN(a)&&(n=0,a=0),_(parseInt(a.toString())),S(n.toFixed(b))}}}})]}),Object(te.jsxs)(be.a,{span:24,children:[Object(te.jsx)(V.a,{loading:v,type:"primary",size:"large",onClick:function(){g(!0),n.redeemPoints({points:f,successCB:function(e){S(0),_(0),g(!1),pe.b.success(e.data.message)},failCB:function(e){var t=e.error;g(!1),pe.b.error(t.response.data.message)}})},disabled:!f||p>f,children:r.redeem_button}),Object(te.jsx)("span",{className:"view-redeemed-link",children:Object(te.jsx)(i.b,{to:"".concat(_e,"lpfw-my-points/?tab=balance"),children:r.view_redeemed})})]})]}),0<l?Object(te.jsx)("div",{className:"expiry-note",dangerouslySetInnerHTML:{__html:r.additional_info.replace("{date_expire}",t.expiry)}}):null]})})),ye=X.a.TabPane,he=function(){var e=Object(c.useState)(""),t=Object(G.a)(e,2),n=t[0],a=t[1],r=lpfwMyPoints.labels,o=new URLSearchParams(Object(u.f)().search),s=Object(u.e)(),i=o.get("tab"),l=ee();Object(c.useEffect)((function(){return a(i||"balance")}),[i]);return Object(te.jsxs)(X.a,{activeKey:n,defaultActiveKey:n,onTabClick:function(e){a(e),s.push("".concat(l,"lpfw-my-points/?tab=").concat(e))},children:[Object(te.jsx)(ye,{tab:r.points_balance,children:Object(te.jsx)(se,{})},"balance"),Object(te.jsx)(ye,{tab:r.points_history,children:Object(te.jsx)(le,{})},"history"),Object(te.jsx)(ye,{tab:r.redeem_points,children:Object(te.jsx)(xe,{})},"redeem")]})},Se=n(205),me=n.n(Se),Ee=n(201),ve=n.n(Ee),ge=n(202),Ne=n.n(ge),Te=n(203),Ce=n.n(Te),Re=n(204),Ie=n.n(Re),we=function(){var e=lpfwMyPoints.app_lang;return"en_GB"===e?ve.a:e.includes("fr_")?Ne.a:e.includes("_RU")?Ce.a:e.includes("pt_")?Ie.a:me.a},Pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=Object(b.a)(),n=Object(d.createStore)(Object(d.combineReducers)({balance:x,coupons:g,history:C}),e,W([t]));return t.run(K),n}(),Ae=ee();document.querySelectorAll("#lpfw_my_points_app").forEach((function(e){o.a.render(Object(te.jsx)(s.a,{store:Pe,children:Object(te.jsx)(l.a,{locale:we(),children:Object(te.jsx)(i.a,{children:Object(te.jsx)(u.a,{path:"".concat(Ae,"lpfw-my-points/"),component:he})})})}),e)}))}},[[342,1,2]]]);
//# sourceMappingURL=main.66c287ed.chunk.js.map